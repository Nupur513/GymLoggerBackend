generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id        String        @id @default(auto()) @map("_id") @db.ObjectId
  firstName String
  lastName  String
  email     String        @unique
  password  String
  weight    Int?
  height    Int?
  friends   UserFriends[] @relation("UserFriends_user")
  friendOf  UserFriends[] @relation("UserFriends_friend")
  exercises Exercise[] // Back relation to Exercise model
  Workout   Workout[]
}

model UserFriends {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  userId   String
  friendId String
  user     User   @relation("UserFriends_user", fields: [userId], references: [id])
  friend   User   @relation("UserFriends_friend", fields: [friendId], references: [id])

  @@unique([userId, friendId])
}

model Exercise {
  id               String            @id @default(auto()) @map("_id") @db.ObjectId
  name             String            @unique
  bodyPart         String
  equipment        String
  description      String?
  workoutExercises WorkoutExercise[] // Back relation to WorkoutExercise model
  User             User?             @relation(fields: [userId], references: [id])
  userId           String?           @db.ObjectId
}

model WorkoutExercise {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  exercise   Exercise @relation(fields: [exerciseId], references: [id])
  exerciseId String
  name       String
  sets       Int
  reps       Int
  weight     Int
  status     Status   @default(yetToStart)
  workout    Workout  @relation("WorkoutToWorkoutExercise", fields: [workoutId], references: [id])
  workoutId  String
}

model Workout {
  id               String            @id @default(auto()) @map("_id") @db.ObjectId
  status           Status            @default(yetToStart)
  created          DateTime          @default(now())
  workoutExercises WorkoutExercise[] @relation("WorkoutToWorkoutExercise")
  userId           String?
  user             User?             @relation(fields: [userId], references: [id])
}

enum Status {
  active
  completed
  yetToStart
}
